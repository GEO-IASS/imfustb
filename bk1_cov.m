function [b_map, d_map]=bk1_cov(a, b, w)

fun=inline('repmat(mean2(x), size(x))');
%fun=inline('mean2((x-mean2(x)).*(y-mean2(y)))');

double_a=double(a);
double_b=double(b);

mean_a=blkproc(double_a, size(w), floor(size(w)/2), fun);
mean_b=blkproc(double_b, size(w), floor(size(w)/2), fun);

cov_ab=blkproc((double_a-mean_a).*(double_b-mean_b), size(w), floor(size(w)/2), fun);

b_map=cov_ab;
%d_map=b_map;
[b_map, d_map]=ut_prpmp(b_map, jet(256), size(a));


% [b_map, d_map]=ut_prpmp(b_map, jet(256), size(a));